{
  "version": 3,
  "sources": ["../src/index.ts", "../src/effect.ts", "../src/ref.ts"],
  "sourcesContent": ["export * from \"./ref\";\r\nexport * from \"./effect\";\r\n", "/**\r\n * \u7528\u6765\u4FDD\u5B58\u5F53\u524D\u6B63\u5728\u6267\u884C\u7684\u526F\u4F5C\u7528\u51FD\u6570\r\n */\r\nexport let activeSub;\r\n\r\n/**\r\n * effect \u54CD\u5E94\u5F0F\u53D8\u91CF\u66F4\u65B0\u540E\u4F1A\u91CD\u65B0\u6267\u884C\u4F20\u5165\u7684\u51FD\u6570\r\n * @param fn\r\n */\r\nexport function effect(fn: Function) {\r\n  activeSub = fn;\r\n  activeSub();\r\n\r\n  activeSub = undefined;\r\n}\r\n", "import { activeSub } from \"./effect\";\r\n\r\nenum ReactiveFlags {\r\n  /**\r\n   * \u6807\u8BC6\u4E00\u4E2A\u5BF9\u8C61\u662F\u54CD\u5E94\u5F0F\u7684\u5F15\u7528\u7C7B\u578B\r\n   */\r\n  IS_REF = \"__v_isRef\",\r\n}\r\n\r\nclass RefImpl<T> {\r\n  /**\r\n   * \u5B58\u50A8\u5B9E\u9645\u7684\u503C\r\n   */\r\n  _value: T;\r\n\r\n  /**\r\n   * \u6807\u8BC6\u8BE5\u5BF9\u8C61\u662F\u54CD\u5E94\u5F0F\u5F15\u7528\u7C7B\u578B ref\u6807\u8BB0\uFF0C\u8BC1\u660E\u662F\u4E00\u4E2A ref\r\n   */\r\n  [ReactiveFlags.IS_REF]: boolean = true;\r\n\r\n  /**\r\n   * \u4FDD\u5B58\u548C effect \u4E4B\u95F4\u7684\u5173\u8054\u5173\u7CFB\r\n   */\r\n  subs;\r\n\r\n  constructor(value: T) {\r\n    this._value = value;\r\n  }\r\n\r\n  get value(): T {\r\n    // \u6536\u96C6\u4F9D\u8D56\r\n\r\n    if (activeSub) {\r\n      // \u5982\u679C avtiveSub \u6709\u503C\uFF0C\u90A3\u5C31\u4FDD\u5B58\u8D77\u6765\r\n      this.subs = activeSub;\r\n    }\r\n\r\n    return this._value;\r\n  }\r\n\r\n  set value(newValue: T) {\r\n    // \u89E6\u53D1\u4F9D\u8D56\u66F4\u65B0\r\n\r\n    this._value = newValue;\r\n\r\n    // \u901A\u77E5 effect \u91CD\u65B0\u6267\u884C\uFF0C\u83B7\u53D6\u5230\u6700\u65B0\u7684\u503C\r\n    this.subs?.();\r\n  }\r\n}\r\n\r\n/**\r\n * \u521B\u5EFA\u4E00\u4E2A\u54CD\u5E94\u5F0F\u5F15\u7528\u5BF9\u8C61\r\n * @param value \u5C06\u8981\u5305\u88C5\u6210\u54CD\u5E94\u5F0F\u7684\u503C\r\n * @returns\r\n */\r\nexport function ref<T>(value: T) {\r\n  return new RefImpl<T>(value);\r\n}\r\n\r\n/**\r\n * \u5224\u65AD\u4E00\u4E2A\u503C\u662F\u5426\u662F\u54CD\u5E94\u5F0F\u5F15\u7528\u7C7B\u578B(ref)\r\n * @param value \u5C06\u8981\u5224\u65AD\u7684\u503C\r\n * @returns\r\n */\r\nexport function isRef(value) {\r\n  return !!(value && value[ReactiveFlags.IS_REF]);\r\n}\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACGO,MAAI;AAMJ,WAAS,OAAO,IAAc;AACnC,gBAAY;AACZ,cAAU;AAEV,gBAAY;AAAA,EACd;;;ACLA,MAAM,UAAN,MAAiB;AAAA;AAAA;AAAA;AAAA,IAIf;AAAA;AAAA;AAAA;AAAA,IAKA,CAAC,wBAAoB,IAAa;AAAA;AAAA;AAAA;AAAA,IAKlC;AAAA,IAEA,YAAY,OAAU;AACpB,WAAK,SAAS;AAAA,IAChB;AAAA,IAEA,IAAI,QAAW;AAGb,UAAI,WAAW;AAEb,aAAK,OAAO;AAAA,MACd;AAEA,aAAO,KAAK;AAAA,IACd;AAAA,IAEA,IAAI,MAAM,UAAa;AAGrB,WAAK,SAAS;AAGd,WAAK,OAAO;AAAA,IACd;AAAA,EACF;AAOO,WAAS,IAAO,OAAU;AAC/B,WAAO,IAAI,QAAW,KAAK;AAAA,EAC7B;AAOO,WAAS,MAAM,OAAO;AAC3B,WAAO,CAAC,EAAE,SAAS,MAAM,wBAAoB;AAAA,EAC/C;",
  "names": []
}
